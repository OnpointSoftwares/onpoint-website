{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
<style>
    /* Documentation specific styles */
    .docs-sidebar {
        position: sticky;
        top: 120px;
        height: calc(100vh - 140px);
        overflow-y: auto;
        padding-right: 1rem;
        scrollbar-width: thin;
        scrollbar-color: var(--bs-primary) rgba(255,255,255,0.1);
    }
    
    .docs-sidebar::-webkit-scrollbar {
        width: 6px;
    }
    
    .docs-sidebar::-webkit-scrollbar-track {
        background: rgba(255,255,255,0.05);
        border-radius: 3px;
    }
    
    .docs-sidebar::-webkit-scrollbar-thumb {
        background-color: var(--bs-primary);
        border-radius: 3px;
    }
    
    .docs-content {
        padding: 2rem 0;
    }
    
    .section {
        padding: 2.5rem 0;
        border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    
    .section:last-child {
        border-bottom: none;
    }
    
    .feature-card {
        background: rgba(255,255,255,0.03);
        border-radius: 0.5rem;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
        transition: all 0.3s ease;
        border: 1px solid rgba(255,255,255,0.05);
        height: 100%;
    }
    
    .feature-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 0.5rem 1.5rem rgba(0,0,0,0.2);
        border-color: var(--bs-primary);
    }
    
    .nav-link {
        color: var(--bs-gray-400);
        padding: 0.5rem 0;
        transition: all 0.2s ease;
    }
    
    .nav-link:hover, .nav-link:focus {
        color: var(--bs-white);
        padding-left: 0.5rem;
    }
    
    .nav-link.active {
        color: var(--bs-primary) !important;
        font-weight: 600;
        background: none;
        padding-left: 0.5rem;
        border-left: 2px solid var(--bs-primary);
    }
    
    pre {
        background: #1a1e24;
        padding: 1.25rem;
        border-radius: 0.5rem;
        border-left: 3px solid var(--bs-primary);
        color: #e6e6e6;
        margin: 1.5rem 0;
    }
    
    code {
        color: #f8f9fa;
        background: rgba(255,255,255,0.1);
        padding: 0.2rem 0.4rem;
        border-radius: 0.25rem;
        font-size: 0.9em;
    }
    
    .alert {
        border-radius: 0.5rem;
        border: none;
        box-shadow: 0 0.125rem 0.25rem rgba(0,0,0,0.1);
    }
    
    .card {
        border: 1px solid rgba(255,255,255,0.05);
        background: rgba(255,255,255,0.03);
        transition: all 0.3s ease;
    }
    
    .card:hover {
        transform: translateY(-2px);
        box-shadow: 0 0.5rem 1.5rem rgba(0,0,0,0.1);
    }
    
    .btn-outline-primary {
        --bs-btn-hover-bg: var(--bs-primary);
        --bs-btn-hover-border-color: var(--bs-primary);
    }
    
    @media (max-width: 991.98px) {
        .docs-sidebar {
            position: relative;
            top: 0;
            height: auto;
            margin-bottom: 2rem;
            padding-right: 0;
        }
        
        .section {
            padding: 1.5rem 0;
        }
    }
</style>
{% endblock %}

{% block content %}
<!-- Page Header -->
<header class="bg-gradient-dark py-5 mb-5 border-bottom border-dark">
    <div class="container py-4">
        <div class="row align-items-center">
            <div class="col-lg-8">
                <nav aria-label="breadcrumb" class="mb-3">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="/" class="text-decoration-none">Home</a></li>
                        <li class="breadcrumb-item"><a href="#" class="text-decoration-none">Products</a></li>
                        <li class="breadcrumb-item active text-muted" aria-current="page">BizFlow POS</li>
                    </ol>
                </nav>
                <h1 class="display-4 fw-bold text-white mb-3">BizFlow POS Documentation</h1>
                <div class="d-flex flex-wrap align-items-center gap-3 mb-3">
                    <span class="badge bg-primary bg-opacity-10 text-primary px-3 py-2">
                        <i class="bi bi-tag-fill me-2"></i> v1.0.0
                    </span>
                    <span class="badge bg-success bg-opacity-10 text-success px-3 py-2">
                        <i class="bi bi-check-circle-fill me-2"></i> Latest Version
                    </span>
                </div>
                <p class="lead text-muted mb-0">A comprehensive guide to installing, configuring, and using the BizFlow Point of Sale system for your business.</p>
            </div>
            <div class="col-lg-4 text-lg-end mt-4 mt-lg-0">
                <div class="d-flex flex-column gap-3">
                    <a href="#download" class="btn btn-primary btn-lg w-100">
                        <i class="bi bi-download me-2"></i> Download Now
                    </a>
                    <a href="#getting-started" class="btn btn-outline-light btn-lg w-100">
                        <i class="bi bi-rocket me-2"></i> Get Started
                    </a>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Main Content -->
<div class="container">
    <div class="row">
        <!-- Sidebar -->
        <div class="col-lg-3">
            <div class="docs-sidebar">
                <div class="card border-0 shadow-sm mb-4">
                    <div class="card-header bg-transparent border-bottom border-secondary">
                        <h5 class="mb-0 fw-bold">Documentation</h5>
                    </div>
                    <div class="card-body p-0">
                        <div class="nav flex-column" id="docsNav">
                            <a class="nav-link px-4 py-3 border-bottom border-secondary" href="#overview">
                                <i class="bi bi-house-door-fill me-2"></i> Overview
                                <i class="bi bi-chevron-right ms-auto opacity-50"></i>
                            </a>
                            <a class="nav-link px-4 py-3 border-bottom border-secondary" href="#installation">
                                <i class="bi bi-download me-2"></i> Installation
                                <i class="bi bi-chevron-right ms-auto opacity-50"></i>
                            </a>
                            <a class="nav-link px-4 py-3 border-bottom border-secondary" href="#getting-started">
                                <i class="bi bi-lightning-charge-fill me-2"></i> Getting Started
                                <i class="bi bi-chevron-right ms-auto opacity-50"></i>
                            </a>
                            <a class="nav-link px-4 py-3 border-bottom border-secondary" href="#features">
                                <i class="bi bi-stars me-2"></i> Features
                                <i class="bi bi-chevron-right ms-auto opacity-50"></i>
                            </a>
                            <a class="nav-link px-4 py-3 border-bottom border-secondary" href="#user-guide">
                                <i class="bi bi-journal-bookmark-fill me-2"></i> User Guide
                                <i class="bi bi-chevron-right ms-auto opacity-50"></i>
                            </a>
                            <a class="nav-link px-4 py-3 border-bottom border-secondary" href="#troubleshooting">
                                <i class="bi bi-tools me-2"></i> Troubleshooting
                                <i class="bi bi-chevron-right ms-auto opacity-50"></i>
                            </a>
                            <a class="nav-link px-4 py-3" href="#faq">
                                <i class="bi bi-question-circle-fill me-2"></i> FAQ
                                <i class="bi bi-chevron-right ms-auto opacity-50"></i>
                            </a>
                        </div>
                    </div>
                </div>
                
                <div class="card border-0 shadow-sm mb-4">
                    <div class="card-header bg-transparent border-bottom border-secondary">
                        <h5 class="mb-0 fw-bold">Resources</h5>
                    </div>
                    <div class="card-body">
                        <a href="#" class="d-flex align-items-center text-decoration-none text-white mb-3">
                            <div class="bg-primary bg-opacity-10 p-2 rounded-3 me-3">
                                <i class="bi bi-file-earmark-text-fill text-primary"></i>
                            </div>
                            <div>
                                <h6 class="mb-0">API Reference</h6>
                                <small class="text-muted">Complete API documentation</small>
                            </div>
                        </a>
                        <a href="#" class="d-flex align-items-center text-decoration-none text-white mb-3">
                            <div class="bg-success bg-opacity-10 p-2 rounded-3 me-3">
                                <i class="bi bi-collection-play-fill text-success"></i>
                            </div>
                            <div>
                                <h6 class="mb-0">Video Tutorials</h6>
                                <small class="text-muted">Step-by-step guides</small>
                            </div>
                        </a>
                        <a href="#" class="d-flex align-items-center text-decoration-none text-white">
                            <div class="bg-info bg-opacity-10 p-2 rounded-3 me-3">
                                <i class="bi bi-github text-info"></i>
                            </div>
                            <div>
                                <h6 class="mb-0">GitHub Repository</h6>
                                <small class="text-muted">Contribute on GitHub</small>
                            </div>
                        </a>
                    </div>
                </div>
                
                <div class="card border-0 shadow-sm">
                    <div class="card-body text-center">
                        <div class="mb-3">
                            <i class="bi bi-headset text-primary" style="font-size: 2.5rem;"></i>
                        </div>
                        <h5 class="h6 mb-2">Need Help?</h5>
                        <p class="small text-muted mb-3">Our support team is here to help you with any questions.</p>
                        <a href="mailto:support@onpoint.com" class="btn btn-outline-primary w-100">
                            <i class="bi bi-envelope me-2"></i> Contact Support
                        </a>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Content -->
        <div class="col-lg-9">
            <div class="docs-content">
        <ul class="nav-menu">
            <li><a href="#overview" class="active"><i class="fas fa-home"></i> Overview</a></li>
            <li><a href="#installation"><i class="fas fa-download"></i> Installation</a></li>
            <li><a href="#getting-started"><i class="fas fa-rocket"></i> Getting Started</a></li>
            <li><a href="#features"><i class="fas fa-star"></i> Features</a></li>
            <li><a href="#user-guide"><i class="fas fa-book"></i> User Guide</a></li>
            <li><a href="#troubleshooting"><i class="fas fa-question-circle"></i> Troubleshooting</a></li>
            <li><a href="#faq"><i class="fas fa-question"></i> FAQ</a></li>
        </ul>
    </nav>

    <!-- Mobile Menu Toggle -->
    <button class="menu-toggle" id="menuToggle">
        <i class="fas fa-bars"></i>
    </button>

    <!-- Main Content -->
    <main class="main-content">
        <section id="overview" class="section">
            <h1>BizFlow POS Documentation</h1>
            <p class="lead">A comprehensive guide to installing, configuring, and using the BizFlow Point of Sale system.</p>
            
            <div class="alert alert-info">
                <i class="fas fa-info-circle"></i> 
                <strong>Latest Version:</strong> v1.0.0 | Last Updated: August 23, 2025
            </div>

            <h2>About BizFlow POS</h2>
            <p>BizFlow POS is a modern, user-friendly point of sale system designed for small to medium-sized businesses. It provides a complete solution for managing sales, inventory, and customer data in one integrated platform.</p>
            
            <h3>Key Benefits</h3>
            <ul>
                <li>Simple and intuitive user interface</li>
                <li>Real-time inventory management</li>
                <li>Comprehensive sales reporting</li>
                <li>Multi-user support with role-based access</li>
                <li>Cross-platform compatibility</li>
            </ul>
            
            <div class="download-section" id="download" style="background: #f8f9fa; padding: 2rem; border-radius: 8px; margin: 2rem 0; border: 1px solid #e1e4e8; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
                <div style="text-align: center; margin-bottom: 2rem;">
                    <h2 style="margin-top: 0; color: #2c3e50;"><i class="fas fa-download"></i> Download BizFlow POS</h2>
                    <p style="color: #6c757d; max-width: 700px; margin: 0 auto;">Get the latest version of BizFlow POS for your operating system. Simply download and install the package for your platform.</p>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; margin: 2rem 0;">
                    <!-- Windows Download Card -->
                    <div style="background: white; border-radius: 8px; padding: 1.5rem; border: 1px solid #e1e4e8; transition: transform 0.2s, box-shadow 0.2s;">
                        <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                            <div style="background: #e6f0ff; width: 48px; height: 48px; border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                                <i class="fab fa-windows" style="font-size: 1.5rem; color: #0078d4;"></i>
                            </div>
                            <h3 style="margin: 0;">Windows</h3>
                        </div>
                        <p style="color: #6c757d; margin-bottom: 1.5rem;">For Windows 10/11 (64-bit)</p>
                        <a href="https://github.com/OnpointSoftwares/BizFlow/raw/main/bizflow-pos-windows-1.0.0.zip" download="bizflow-pos-windows-1.0.0.zip" class="btn" style="display: block; background: #4a6baf; color: white; text-align: center; padding: 0.75rem; border-radius: 6px; text-decoration: none; font-weight: 500; transition: background 0.2s;">
                            <i class="fas fa-download"></i> Download for Windows
                        </a>
                        <div style="margin-top: 1rem; font-size: 0.85em; color: #6c757d;">
                            <div><i class="fas fa-file-archive"></i> bizflow-pos-windows-1.0.0.zip</div>
                            <div><i class="fas fa-info-circle"></i> Includes Windows installer</div>
                        </div>
                    </div>
                    
                    <!-- Linux Download Card -->
                    <div style="background: white; border-radius: 8px; padding: 1.5rem; border: 1px solid #e1e4e8; transition: transform 0.2s, box-shadow 0.2s;">
                        <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                            <div style="background: #f0f0f0; width: 48px; height: 48px; border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                                <i class="fab fa-linux" style="font-size: 1.5rem; color: #333;"></i>
                            </div>
                            <h3 style="margin: 0;">Linux</h3>
                        </div>
                        <p style="color: #6c757d; margin-bottom: 1.5rem;">For Ubuntu/Debian and other Linux distributions</p>
                        <a href="https://github.com/OnpointSoftwares/BizFlow/raw/main/bizflow-pos-linux-1.0.0.tar.gz" download="bizflow-pos-linux-1.0.0.tar.gz" class="btn" style="display: block; background: #333; color: white; text-align: center; padding: 0.75rem; border-radius: 6px; text-decoration: none; font-weight: 500; transition: background 0.2s;">
                            <i class="fas fa-download"></i> Download for Linux
                        </a>
                        <div style="margin-top: 1rem; font-size: 0.85em; color: #6c757d;">
                            <div><i class="fas fa-file-archive"></i> bizflow-pos-linux-1.0.0.tar.gz</div>
                            <div><i class="fas fa-terminal"></i> Includes installation script</div>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 2rem; padding: 1rem; background: #f0f8ff; border-radius: 6px; border-left: 4px solid #4a6baf;">
                    <div style="display: flex; align-items: flex-start; gap: 0.75rem;">
                        <div style="color: #4a6baf; font-size: 1.25rem;">
                            <i class="fas fa-info-circle"></i>
                        </div>
                        <div>
                            <h4 style="margin-top: 0; margin-bottom: 0.5rem; color: #2c3e50;">System Requirements</h4>
                            <ul style="margin: 0; padding-left: 1.25rem; color: #4a5568;">
                                <li>Java 11 or later</li>
                                <li>2GB RAM minimum (4GB recommended)</li>
                                <li>200MB free disk space</li>
                                <li>Screen resolution: 1024x768 or higher</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="installation" class="section">
            <h2>Installation Guide</h2>
            
            <h3>System Requirements</h3>
            <table>
                <tr>
                    <th>Component</th>
                    <th>Minimum</th>
                    <th>Recommended</th>
                </tr>
                <tr>
                    <td>Operating System</td>
                    <td>Windows 10 / Ubuntu 20.04 LTS / macOS 10.15</td>
                    <td>Windows 11 / Ubuntu 22.04 LTS / macOS 12+</td>
                </tr>
                <tr>
                    <td>Java Version</td>
                    <td>Java 11</td>
                    <td>Java 17 LTS</td>
                </tr>
                <tr>
                    <td>RAM</td>
                    <td>4GB</td>
                    <td>8GB or more</td>
                </tr>
                <tr>
                    <td>Storage</td>
                    <td>200MB free space</td>
                    <td>500MB free space</td>
                </tr>
                <tr>
                    <td>Display</td>
                    <td>1366x768</td>
                    <td>1920x1080 or higher</td>
                </tr>
            </table>

            <h3>Windows Installation</h3>
            <ol>
                <li>Download the Windows package (<code>bizflow-pos-windows-1.0.0.zip</code>)</li>
                <li>Extract the ZIP file to your preferred location</li>
                <li>Double-click <code>Start-BizFlowPOS.bat</code> to launch the application</li>
                <li>If prompted, allow the application to make changes to your device</li>
            </ol>

            <h3>Linux Installation</h3>
            <ol>
                <li>Download the Linux package (<code>bizflow-pos-linux-1.0.0.tar.gz</code>)</li>
                <li>Extract the archive:
                    <pre><code>tar -xzf bizflow-pos-linux-1.0.0.tar.gz</code></pre>
                </li>
                <li>Run the installer with root privileges:
                    <pre><code>cd bizflow-pos-linux-1.0.0
sudo ./linux-installer.sh</code></pre>
                </li>
                <li>After installation, you can launch the application from your applications menu or by typing <code>bizflow-pos</code> in the terminal</li>
            </ol>

            <div class="alert alert-warning">
                <i class="fas fa-exclamation-triangle"></i>
                <strong>Note:</strong> On first run, the application will create a default admin user. The default credentials are:
                <ul>
                    <li>Username: <code class="text-muted">admin</code></li>
                    <li>Password: <code class="text-muted">admin</code></li>
                </ul>
                <ul>
                    <li>Username: <code class="text-muted">cashier</code></li>
                    <li>Password: <code class="text-muted">cashier</code></li>
                </ul>
                <p>Please change the default password after your first login.</p>
            </div>
        </section>

        <section id="getting-started" class="section">
            <h2>Getting Started</h2>
            
            <h3>First-Time Setup</h3>
            <ol>
                <li>Launch the application</li>
                <li>Log in with the default credentials</li>
                <li>Navigate to <strong>Settings</strong> > <strong>Users</strong> to change the default password</li>
                <li>Configure your business information in <strong>Settings</strong> > <strong>Business Profile</strong></li>
                <li>Set up your tax rates in <strong>Settings</strong> > <strong>Tax Rates</strong></li>
                <li>Add your products to the inventory</li>
            </ol>

            <h3>User Interface Overview</h3>
            <p>The main interface consists of several key areas:</p>
            <ul>
                <li><strong>Navigation Menu</strong> - Access different modules (Sales, Inventory, Reports, etc.)</li>
                <li><strong>Toolbar</strong> - Quick access to common actions</li>
                <li><strong>Main Workspace</strong> - Displays the content of the selected module</li>
                <li><strong>Status Bar</strong> - Shows system status and notifications</li>
            </ul>
        </section>

        <section id="features" class="section">
            <h2>Features</h2>
            
            <div class="feature">
                <h3><i class="fas fa-shopping-cart"></i> Sales Management</h3>
                <p>Process sales quickly and efficiently with an intuitive interface.</p>
                <ul>
                    <li>Fast product lookup by name, barcode, or SKU</li>
                    <li>Support for various payment methods (Cash, Card, Mobile Pay)</li>
                    <li>Discount and promotion handling</li>
                    <li>Receipt printing and emailing</li>
                </ul>
            </div>

            <div class="feature">
                <h3><i class="fas fa-boxes"></i> Inventory Control</h3>
                <p>Keep track of your stock levels in real-time.</p>
                <ul>
                    <li>Product management with categories and variants</li>
                    <li>Low stock alerts</li>
                    <li>Purchase order management</li>
                    <li>Bulk import/export functionality</li>
                </ul>
            </div>

            <div class="feature">
                <h3><i class="fas fa-chart-line"></i> Reporting</h3>
                <p>Make informed business decisions with comprehensive reports.</p>
                <ul>
                    <li>Sales reports by date, product, category</li>
                    <li>Inventory valuation</li>
                    <li>Tax reports</li>
                    <li>Export to Excel/PDF</li>
                </ul>
            </div>
        </section>

        <section id="user-guide" class="section">
            <h2>User Guide</h2>
            
            <h3>Processing a Sale</h3>
            <ol>
                <li>Click on <strong>New Sale</strong> from the dashboard</li>
                <li>Add products by scanning barcodes or searching by name</li>
                <li>Apply any discounts or promotions if needed</li>
                <li>Select the payment method</li>
                <li>Complete the transaction</li>
                <li>Print or email the receipt</li>
            </ol>

            <h3>Managing Inventory</h3>
            <h4>Adding a New Product</h4>
            <ol>
                <li>Go to <strong>Inventory</strong> > <strong>Products</strong></li>
                <li>Click <strong>Add Product</strong></li>
                <li>Fill in the product details (name, SKU, price, etc.)</li>
                <li>Set the initial stock level</li>
                <li>Upload product images if available</li>
                <li>Click <strong>Save</strong></li>
            </ol>

            <h4>Updating Stock Levels</h4>
            <ol>
                <li>Go to <strong>Inventory</strong> > <strong>Stock Adjustment</strong></li>
                <li>Select the product to update</li>
                <li>Enter the new quantity or adjust by a specific amount</li>
                <li>Add a note explaining the adjustment</li>
                <li>Click <strong>Update Stock</strong></li>
            </ol>
        </section>

        <section id="troubleshooting" class="section">
            <h2>Troubleshooting</h2>
            
            <h3>Common Issues</h3>
            
            <div class="alert alert-danger">
                <h4><i class="fas fa-exclamation-circle"></i> Application won't start</h4>
                <p><strong>Possible causes:</strong></p>
                <ul>
                    <li>Java is not installed or not in the system PATH</li>
                    <li>Insufficient system resources</li>
                    <li>Corrupted installation files</li>
                </ul>
                <p><strong>Solutions:</strong></p>
                <ol>
                    <li>Verify Java installation by running <code>java -version</code> in the terminal/command prompt</li>
                    <li>Download and install the latest Java Runtime Environment (JRE) from <a href="https://adoptium.net/" target="_blank">Eclipse Temurin</a></li>
                    <li>Try reinstalling the application</li>
                </ol>
            </div>

            <div class="alert alert-warning">
                <h4><i class="fas fa-exclamation-triangle"></i> Database connection errors</h4>
                <p><strong>Possible causes:</strong></p>
                <ul>
                    <li>Insufficient file permissions</li>
                    <li>Database file is locked by another process</li>
                    <li>Corrupted database file</li>
                </ul>
                <p><strong>Solutions:</strong></p>
                <ol>
                    <li>Make sure the application has write permissions to the installation directory</li>
                    <li>Restart your computer to ensure no other instances are running</li>
                    <li>Restore from a recent backup if available</li>
                </ol>
            </div>
        </section>

        <section id="faq" class="section">
            <h2>Frequently Asked Questions</h2>
            
            <div class="faq-item">
                <h3>How do I update the application?</h3>
                <p>To update the application:</p>
                <ol>
                    <li>Download the latest version</li>
                    <li>Back up your database (located in the installation directory)</li>
                    <li>Install the new version following the installation instructions</li>
                    <li>Restore your database backup if necessary</li>
                </ol>
            </div>

            <div class="faq-item">
                <h3>Can I use BizFlow POS on multiple computers?</h3>
                <p>Yes, you can install BizFlow POS on multiple computers. However, you'll need to ensure that only one instance is accessing the database file at a time if you're using the default file-based database. For multi-user access, consider setting up a centralized database server.</p>
            </div>

            <div class="faq-item">
                <h3>How do I back up my data?</h3>
                <p>To back up your data:</p>
                <ol>
                    <li>Close the application</li>
                    <li>Locate the database file (<code>pos.db</code> in the installation directory)</li>
                    <li>Copy this file to a secure backup location</li>
                </ol>
                <p>For automated backups, you can set up a scheduled task or cron job to copy the database file periodically.</p>
            </div>
        </section>

            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // Highlight active section in navigation
    document.addEventListener('DOMContentLoaded', function() {
        const sections = document.querySelectorAll('section[id]');
        const navLinks = document.querySelectorAll('#docsNav .nav-link');
        
        function updateActiveNav() {
            let current = '';
            const scrollPosition = window.scrollY + 200;
            
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.offsetHeight;
                
                if (scrollPosition >= sectionTop && scrollPosition < sectionTop + sectionHeight) {
                    current = '#' + section.getAttribute('id');
                }
            });
            
            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === current) {
                    link.classList.add('active');
                }
            });
        }
        
        window.addEventListener('scroll', updateActiveNav);
        updateActiveNav();
    });
</script>
{% endblock %}
